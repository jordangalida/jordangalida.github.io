<!DOCTYPE html>
<html lang="en-us">
<title>Custom Dropper | Malware Blog</title>
<meta charset="utf-8">
<meta name="generator" content="Hugo 0.91.2" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://jordangalida.github.io/css/index.css">
<link rel="canonical" href="https://jordangalida.github.io/posts/customdropper/">
<link rel="alternate" type="application/rss+xml" href="" title="Malware Blog">

<header>
  
    <a href="https://jordangalida.github.io/" class="title">Malware Blog</a>
  
  
</header>

<article>
  <header>
    <h1>Custom Dropper</h1>
    <time datetime="2022-01-12T13:20:47-05:00">January 12, 2022</time>
  </header>
  <h2 id="writing-custom-malware-for-red-teams">Writing Custom Malware For Red Teams</h2>
<p>Why should you write your own custom malware? Threat Hunters and AV engines are becoming more advanced and proficient at identifying and removing malware. Additionally, using malware templates written by some unkonwn person can <strong>actually</strong> compromise your client.</p>
<h2 id="pe-format">PE Format</h2>
<p>Portable Executable Format is simply a way that an executable&rsquo;s code is organized on the disk so that the Windows OS Loader can read it,load it into memory as a process, and execute it.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/Portable_Executable_32_bit_Structure_in_SVG_fixed.svg/1024px-Portable_Executable_32_bit_Structure_in_SVG_fixed.svg.png" alt="PE Format"></p>
<h2 id="what-does-a-basic-pe-look-like">What Does a Basic PE Look Like?</h2>
<p>Well, if you&rsquo;ve ever written in C, it&rsquo;s just a basic program!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;windows.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>) {
	printf(<span style="color:#e6db74">&#34;I am a basic PE!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
	
	getchar();

	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><h2 id="function-call-obfuscation">Function Call Obfuscation</h2>
<p>Suspicious shopping list analogy</p>

</article>



</html>
